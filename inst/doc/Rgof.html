<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>R Package Rgof</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">R Package Rgof</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(Rgof)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>Bsim <span class="ot">=</span> <span class="dv">500</span> <span class="co">#Number of Simulation Runs</span></span></code></pre></div>
<p>Note that Bsim is very small, so that this vignette does not take to
long to run. Therefore none of the p values or powers below are
correct.</p>
<p>The package <em>Rgof</em> brings together a number of routines for
the goodness-of-fit problem for univariate data. We have a data set
<span class="math inline">\(\pmb{x}\)</span>, and we want to test
whether it was generated by the probability distribution F.</p>
<p>The highlights of this package are:</p>
<ul>
<li>it runs a large number of different tests simultaneously.</li>
<li>it can run several tests and find an adjusted p value for the
combination of all the tests.</li>
<li>it works for continuous and for discrete (aka histogram) data.<br />
</li>
<li>it allows for parameter estimation.<br />
</li>
<li>it uses Rcpp and parallel programming to be very fast.<br />
</li>
<li>it includes routines that make it very easy to estimate the power of
the different tests for specific situations.<br />
</li>
<li>it allows for the possibility that the sample size was a draw from a
Poisson random variable.<br />
</li>
<li>it allows the user to add more tests.<br />
</li>
<li>it includes a routine to draw the usual power graph.<br />
</li>
<li>it allows the user to compare the power of a new test to those
included in the package for a large number of cases (aka null hypothesis
vs alternative hypothesis).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code></pre></div>
<p><strong>Note</strong> all runs of the test routine are done with
<em>B=1000</em> and all runs of the power routines with arguments
<em>B=500, maxProcessor = 2</em> in order to pass
<em>devtools::check()</em>.</p>
<div id="the-methods" class="section level2">
<h2>The Methods</h2>
<ul>
<li><strong>Continuous Data</strong></li>
</ul>
<ol style="list-style-type: decimal">
<li>Kolmogorov Smirnov (KS) <span class="citation">(Massey 1951)</span>,
<span class="citation">(Kolmogorov 1933)</span>, <span class="citation">(Smirnov 1948)</span></li>
<li>Kuiper (K) <span class="citation">(Kuiper 1960)</span></li>
<li>Anderson-Darling (AD) <span class="citation">(Anderson and Darling
1952)</span>, <span class="citation">(Anderson and Darling
1954)</span></li>
<li>Cramer-vonMises (CvM) <span class="citation">(Anderson
1962)</span><br />
</li>
<li>Wilson (W)<br />
</li>
<li>Zhang’s methods (ZA, ZK, ZC) <span class="citation">(Zhang
2002)</span><br />
</li>
<li>Wasserstein p=1 (Wassp1) <span class="citation">(E del Barrio
1999)</span></li>
</ol>
<p>For all of these tests the distribution of the test statistic under
the null hypothesis is found via simulation.</p>
<ol start="8" style="list-style-type: decimal">
<li>Eight variations of chi square tests, using the formulas by Pearson
or based on the likelihood ratio test, bins of equal size or equal
probability and both a large number and a small number of bins, 50 and
10 by default. The p values are found using the usual chi square
approximation to the null distribution. If parameters are estimated this
is done either via the method of minimum chi square <span class="citation">(Berkson 1980)</span> or via a user-provided estimator.
In all cases bins are combined until all of them have an expected count
of at least 5.</li>
</ol>
<p>There is a very large literature on chi square tests, the oldest of
the goodness of fit tests. For a survey see <span class="citation">(Rolke and Gutierrez-Gongora 2020)</span>.</p>
<ul>
<li><strong>Discrete (Histogram) Data</strong></li>
</ul>
<p>All the methods above are also implemented for discrete data, except
for Zhang’s tests, which have no discrete analog.</p>
<p>It is worth noting that these discrete versions are based on the
theoretical ideas of the tests and not on the actual formula of
calculation for the continuous case. The test statistics can therefore
be different even when applied to the same data. For example, the
Anderson-Darling test is based on the distance measure</p>
<p><span class="math display">\[A^2=n\int_{-\infty}^{\infty}
\frac{(\hat{F}(x)-F(x))^2}{F(x)(1-F(x))}dF(x) \]</span> where <span class="math inline">\(F\)</span> is the theoretical distribution
function under the null hypothesis and <span class="math inline">\(\hat{F}\)</span> is the empirical distribution
function. In the case of continuous data it can be shown that</p>
<p><span class="math display">\[A^2=-n-\frac1n\sum_{i=1}^n
(2i-1)\left(\log F(x_i) +\log[1-F(x_{n+1-i})\right)\]</span> However,
for discrete data we have</p>
<p><span class="math display">\[A^2=n\sum_{i=1}^k
\frac{(\hat{F}(x_i)-F(x_i))^2}{F(x_i)(1-F(x_i))}\left(F(x_i)-F(x_{i-1}\right)\]</span></p>
<p>with <span class="math inline">\(F(x_0)=0\)</span>.</p>
<p>In the continuous case <span class="math inline">\(\hat{F}\)</span>
is a step function but <span class="math inline">\(F\)</span> is
continuous, and therefore <span class="math inline">\(A^2&gt;0\)</span>.
In the discrete case however<span class="math inline">\(A^2=0\)</span>
is possible. This shows that the two cases are fundamentally different
and therefore require different formulas for the test statistic.</p>
<p>As for continuous data null distributions are found using simulation.
In fact in the case of discrete data none of the tests has a known
distribution for the test statistic under the null hypothesis.</p>
<ol start="8" style="list-style-type: decimal">
<li>Four variations of chi square tests, using the formulas by Pearson
and log-likelihood as well as a large number and a small number of bins.
Again the routine combines bins until all have expected counts greater
than 5, and the chi square approximation is used to find p values. The
combination of bins is done in such a way that the bins remain of equal
size as much as possible.</li>
</ol>
<p>These methods can be used for both discrete and histogram data. The
main difference between these two is that discrete data has (a
countable) number of possible values whereas histogram data has possible
ranges of values (the bins). The only method directly affected by this
difference is Wassp1, which requires actual values. All other methods
ignore the <em>vals</em> argument.</p>
</div>
<div id="testing" class="section level2">
<h2>Testing</h2>
<div id="discrete-histogram-datamodel" class="section level3">
<h3>Discrete (Histogram) Data/Model</h3>
<div id="simple-null-hypothesis" class="section level4">
<h4>Simple Null Hypothesis</h4>
<p>We generate a data set of size 1000 from a Binomial distribution with
n=20 and success probability 0.5, and then test <span class="math inline">\(H_0:F=Bin(20, 0.5)\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>vals<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span> <span class="co">#possible values of random variable</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>pnull<span class="ot">=</span><span class="cf">function</span>()  <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)  <span class="co"># cumulative distribution function (cdf)</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># generate data under the null hypothesis, make sure that vector of counts has </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#same length as vals, possibly 0.</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Basic Test</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">B=</span><span class="dv">1000</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; $statistics</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;      KS       K      AD     CvM       W  Wassp1 </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 0.17000 0.17380 0.13280 0.02492 2.04530 0.03457 </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; $p.values</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  0.671  0.754  0.997  0.970  0.669  0.995</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#Test with adjusted overall p value</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">gof_test_adjusted_pvalue</span>(x, vals, pnull, rnull, <span class="at">B=</span><span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">500</span>))</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; p values of individual tests:</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; W :  0.691</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; AD :  0.996</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; s-P :  0.9951</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; adjusted p value of combined tests: 0.938</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.55</span>)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#true p is 0.55, not 0.5</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># Basic Test</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">doMethod =</span> <span class="st">&quot;all&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#Test with adjusted overall p value</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">gof_test_adjusted_pvalue</span>(x, vals, pnull, rnull, <span class="at">B=</span><span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">500</span>))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; p values of individual tests:</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; W :  0</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; AD :  0</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; s-P :  0</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; adjusted p value of combined tests: 0.004</span></span></code></pre></div>
<p>Arguments of <em>gof_test</em> for discrete data/model:</p>
<ul>
<li><p>x: vector with counts (histogram heights). Should have a number
for each value of vals, possibly 0.</p></li>
<li><p>vals: all possible values of discrete random variable, that is
all x with <span class="math inline">\(P(X=x)&gt;0\)</span></p></li>
<li><p>pnull: function to find values of cumulative distribution
function for each value of vals. Function has no arguments.</p></li>
<li><p>rnull: function to generate data from true density. Function has
no arguments. Function needs to insure that output is a vector with same
length as vals.</p></li>
<li><p>B=5000: number of simulation runs</p></li>
<li><p>w: function to find importance sampling weights, if
needed</p></li>
<li><p>phat: function to estimate parameters</p></li>
<li><p>TS: function to find values of user-supplied test
statistics</p></li>
<li><p>TSextra: a list that is passed to TS if any additional info is
required.</p></li>
<li><p>nbins=c(50, 10): number of bins for chi square tests. The first
one is already given by the data in the discrete case, for the second
bins are joined.</p></li>
<li><p>rate=0, if not 0 sample size is assumed to have come from a
Poisson random variable with rate “rate”.</p></li>
<li><p>minexpcount=5, minimal expected counts for chi square
tests.</p></li>
<li><p>ChiUsePhat=TRUE, if TRUE uses user supplied function phat for
parameter estimation. If false uses method of minimum chi
square.</p></li>
<li><p>maxProcessor=1 if greater than 1 number of cores for parallel
processing. Parallel processing is usually not be useful for discrete
data as the single thread version generally runs faster.</p></li>
<li><p>doMethods=“all” names of methods to include</p></li>
</ul>
<p>The arguments of <em>gof_test_adjusted_pvalue</em> for discrete
data/model are the same, except that the number of simulation runs B is
two numbers. The first is used for estimating the individual p values,
the second for the adjustment.</p>
</div>
<div id="random-sample-size" class="section level4">
<h4>Random Sample Size</h4>
<p>In some fields like high energy physics it is common that the sample
size is not fixed but a random variable drawn from a Poisson
distribution with a known rate. Our package runs this as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="fu">rpois</span>(<span class="dv">1</span>, <span class="dv">650</span>), <span class="dv">20</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">rate=</span><span class="dv">650</span>, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</div>
<div id="composite-null-hypothesis" class="section level4">
<h4>Composite Null Hypothesis</h4>
<p>We generate a data set of size 1000 from a binomial distribution with
n=20 and success probability p, and then test F=Bin(20, .). p is
estimated from data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>vals<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>pnull<span class="ot">=</span><span class="cf">function</span>(<span class="at">p=</span><span class="fl">0.5</span>)  <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="fu">ifelse</span>(p<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;&amp;</span>p<span class="sc">&lt;</span><span class="dv">1</span>, p, <span class="fl">0.5</span>))  </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span><span class="sc">*</span>x)<span class="sc">/</span><span class="fu">sum</span>(x)<span class="sc">/</span><span class="dv">20</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span>  </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;  0.660  0.675  0.584  0.830  0.855  0.452</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">20</span>, <span class="fl">0.55</span>)))<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># p is not 0.5, but data is still from a binomial distribution with n=20</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;  0.841  0.941  0.930  0.906  0.648  0.874</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rbinom</span>(<span class="dv">1000-21</span><span class="sc">*</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="fl">0.53</span>))) </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># data has to many small and large values to be from a binomial</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;  0.302  0.008  0.000  0.000  0.000  0.000</span></span></code></pre></div>
<p>The arguments are the same as for the simple hypothesis case, except
that the user has to supply a routine phat to estimate the parameters,
and the functions pnull and rnull now have one argument, namely the
vector with parameter estimates.</p>
<p>The estimation of the parameter(s) in the case of the chi square
tests is done either by using the function phat or via the minimum chi
square method. The routine uses a general function minimizer. If there
are values of the parameter that are not possible this can lead to
warnings. It is best to put a check into the pnull function to avoid
this issue. As an example the function pnull above checks that the
success probability p is in the interval <span class="math inline">\((0,1)\)</span>.</p>
</div>
</div>
<div id="histogram-data" class="section level3">
<h3>Histogram Data</h3>
<p>A variant of discrete data sometimes encountered is data given in the
form of a histogram, that is as a set of bins and their counts. The main
distinction is that discrete data has specific values, for example the
non-negative integers for a Poisson distribution, whereas histogram data
has ranges of numbers, the bins. It turns out that, though, that the
only method that requires actual values is Wassp1, and for that method
one can use the midpoint of the intervals.</p>
<p>As an example consider the following case: we have histogram data and
we want to test whether it comes from an exponential rate 1
distribution, truncated to the interval 0-2:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">2500</span>, <span class="dv">1</span>) <span class="co"># Exp(1) data</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  y <span class="ot">=</span> y[y<span class="sc">&lt;</span><span class="dv">2</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">1500</span>] <span class="co"># 1500 events on 0-2</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  bins <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">40</span><span class="sc">/</span><span class="dv">20</span> <span class="co"># binning</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">hist</span>(y, bins, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>counts <span class="co"># find bin counts</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>}</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>bins <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">40</span><span class="sc">/</span><span class="dv">20</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>vals <span class="ot">=</span> (bins[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">+</span>bins[<span class="sc">-</span><span class="dv">21</span>])<span class="sc">/</span><span class="dv">2</span> <span class="co">#use bin midpoints as values</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>   bins <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span><span class="sc">/</span><span class="dv">20</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>   <span class="fu">pexp</span>(bins, <span class="dv">1</span>)<span class="sc">/</span><span class="fu">pexp</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>}</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull)<span class="sc">$</span>p.value</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; 0.2306 0.1766 0.3854 0.2986 0.3124 0.3732</span></span></code></pre></div>
</div>
<div id="continuous-data" class="section level3">
<h3>Continuous Data</h3>
<div id="simple-hypothesis" class="section level4">
<h4>Simple Hypothesis</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">pnorm</span>(x)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>()  <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>TSextra <span class="ot">=</span> <span class="fu">list</span>(<span class="at">qnull=</span><span class="cf">function</span>(x) <span class="fu">qnorm</span>(x)) <span class="co">#optional quantile function used by chi square tests and Wassp1 test.</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#Basic Tests</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">TSextra=</span>TSextra)<span class="sc">$</span>p.value</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; 0.0500 0.0500 0.1410 0.1520 0.3720 0.3010 0.0580 0.3260 0.1400 0.0098 0.7004 </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; 0.0155 0.2473 0.0123 0.6602 0.0176 0.2287</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#Adjusted p value</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="fu">gof_test_adjusted_pvalue</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">B=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">500</span>), <span class="at">TSextra=</span>TSextra)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; p values of individual tests:</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; W :  0.351</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; ZC :  0.301</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; AD :  0.13</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; ES-s-P :  0.5062</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; adjusted p value of combined tests: 0.349</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>) </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">B=</span><span class="dv">1000</span>, <span class="at">TSextra=</span>TSextra)<span class="sc">$</span>p.value</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0      0      0      0      0      0 </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0</span></span></code></pre></div>
</div>
<div id="composite-hypothesis---one-parameter" class="section level4">
<h4>Composite Hypothesis - One Parameter</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="dv">0</span>) <span class="fu">pnorm</span>(x, p)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>TSextra <span class="ot">=</span> <span class="fu">list</span>(<span class="at">qnull =</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="dv">0</span>) <span class="fu">qnorm</span>(x, p))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(p)  <span class="fu">rnorm</span>(<span class="dv">1000</span>, p)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x)</span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>) </span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; 0.5930 0.5930 0.6990 0.5000 0.4580 0.9270 0.9890 0.8980 0.7470 0.4714 0.9806 </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; 0.1216 0.0164 0.4409 0.9802 0.1261 0.0145</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>) </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra)<span class="sc">$</span>p.value</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; 0.4764 0.4764 0.2880 0.4484 0.4076 0.0698 0.2022 0.0802 0.2342 0.9400 0.5889 </span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; 0.6495 0.8154 0.9315 0.5480 0.6258 0.8094</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>, <span class="dv">2</span>) </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0      0      0      0      0      0 </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0</span></span></code></pre></div>
<p>The arguments of gof_test are the same as in the discrete case,
except that vals=NA. The functions pnull and rnull are functions of one
variable in the case of a simple hypothesis and of two variables in the
case of parameeter estimation.</p>
</div>
<div id="composite-hypothesis---multiple-parameters" class="section level4">
<h4>Composite Hypothesis - Multiple Parameters</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">pnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.001</span>))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>TSextra <span class="ot">=</span> <span class="fu">list</span>(<span class="at">qnull =</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="fu">qnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.001</span>)))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))  <span class="fu">rnorm</span>(<span class="dv">1000</span>, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.001</span>))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>) </span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; 0.1650 0.1650 0.0130 0.0360 0.1110 0.0070 0.0070 0.0040 0.0060 0.1909 0.0098 </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; 0.0879 0.1680 0.1950 0.0101 0.0830 0.1723</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>) </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; 0.2260 0.2260 0.1980 0.2900 0.2990 0.1920 0.4910 0.1510 0.1680 0.0937 0.3452 </span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; 0.2274 0.8267 0.0895 0.3591 0.2640 0.8260</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.5</span>, <span class="dv">2</span>) </span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt; 0.7970 0.7970 0.6300 0.5890 0.5550 0.1860 0.3100 0.2610 0.5460 0.7151 0.8369 </span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; 0.4005 0.6526 0.7376 0.8422 0.4135 0.6551</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="dv">2</span>) </span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TSextra=</span>TSextra, <span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.value</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W     ZA     ZK     ZC Wassp1 ES-l-P ES-s-P </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0      0      0      0      0      0 </span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; EP-l-P EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L </span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0      0      0</span></span></code></pre></div>
</div>
</div>
</div>
<div id="power-estimation" class="section level2">
<h2>Power Estimation</h2>
<p>For estimating the power of the various tests one also has to provide
the routine <em>ralt</em>, which generates data under the alternative
hypothesis:</p>
<div id="discrete-datamodel" class="section level3">
<h3>Discrete Data/Model</h3>
<div id="simple-null-hypothesis-1" class="section level4">
<h4>Simple Null Hypothesis</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>vals <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>rnull <span class="ot">=</span><span class="cf">function</span> () <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>ralt <span class="ot">=</span><span class="cf">function</span> (<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>P<span class="ot">=</span><span class="fu">gof_power</span>(pnull, vals, rnull, ralt, </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="at">param_alt=</span><span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.02</span>), <span class="at">B=</span>Bsim, <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>))</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#&gt; For discrete data only a single processor is used if maxProcessor is not specified</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="fu">plot_power</span>(P, <span class="st">&quot;p&quot;</span>, <span class="at">Smooth=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>In all cases the arguments are the same as for <em>gof_test</em>. In
addition we now have</p>
<ul>
<li><p>ralt: a routine with one parameter that generates data under some
alternative hypothesis.</p></li>
<li><p>param_alt: values to be passed to ralt. This allows the
calculation of the power for many different values.</p></li>
<li><p>alpha=0.05 type I error probability for tests.</p></li>
<li><p>B=1000 the number of simulation runs.</p></li>
</ul>
</div>
<div id="composite-null-hypothesis-1" class="section level4">
<h4>Composite Null Hypothesis</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>vals <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fu">ifelse</span>(<span class="dv">0</span><span class="sc">&lt;</span>p<span class="sc">&amp;</span>p<span class="sc">&lt;</span><span class="dv">1</span>,p,<span class="fl">0.001</span>))</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span> (<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="fu">ifelse</span>(<span class="dv">0</span><span class="sc">&lt;</span>p<span class="sc">&amp;</span>p<span class="sc">&lt;</span><span class="dv">1</span>,p,<span class="fl">0.001</span>))))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span><span class="sc">*</span>x)<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<ul>
<li><strong>Null Hypothesis is true</strong></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>ralt <span class="ot">=</span><span class="cf">function</span> (<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, vals, rnull, ralt, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.6</span>), <span class="at">phat=</span>phat,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>        <span class="at">B=</span>Bsim, <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>), <span class="at">maxProcessor =</span> <span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt;     KS     K    AD   CvM W Wassp1</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; 0.5  0 0.004 0.042 0.030 0  0.058</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; 0.6  0 0.002 0.042 0.042 0  0.044</span></span></code></pre></div>
<p>Note that power estimation in the case of a composite hypothesis (aka
with parameters estimated) is much slower than the simple hypothesis
case.</p>
<ul>
<li><strong>Null Hypothesis is false</strong></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>ralt <span class="ot">=</span><span class="cf">function</span> (<span class="at">p=</span><span class="fl">0.5</span>) <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>), <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">10</span>, p)))</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, vals, rnull, ralt, <span class="fl">0.5</span>, <span class="at">phat=</span>phat,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>        <span class="at">B=</span>Bsim, <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>), <span class="at">maxProcessor =</span> <span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt;     KS      K     AD    CvM      W Wassp1 </span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt;  0.000  0.012  1.000  1.000  0.002  1.000</span></span></code></pre></div>
</div>
</div>
<div id="continuous-datamodel" class="section level3">
<h3>Continuous Data/Model</h3>
<div id="simple-null-hypothesis-2" class="section level4">
<h4>Simple Null Hypothesis</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">pnorm</span>(x)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>TSextra <span class="ot">=</span> <span class="fu">list</span>(<span class="at">qnull =</span> <span class="cf">function</span>(x) <span class="fu">qnorm</span>(x))</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">mu=</span><span class="dv">0</span>) <span class="fu">rnorm</span>(<span class="dv">100</span>, mu)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, <span class="cn">NA</span>, rnull, ralt, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">TSextra=</span>TSextra, <span class="at">B=</span>Bsim)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt; Using  23  cores..</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; maxProcessor set to 1 for faster computation</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt;      KS     K   AD   CvM     W    ZA    ZK    ZC Wassp1 ES-l-P ES-s-P EP-l-P</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; 0 0.038 0.038 0.05 0.054 0.046 0.052 0.064 0.058  0.052   0.04  0.042  0.042</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; 1 1.000 1.000 1.00 1.000 1.000 1.000 1.000 1.000  1.000   1.00  1.000  1.000</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt;   EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; 0  0.056   0.04  0.042  0.038  0.062</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt; 1  1.000   1.00  1.000  1.000  1.000</span></span></code></pre></div>
</div>
<div id="composite-null-hypothesis-2" class="section level4">
<h4>Composite Null Hypothesis</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="fu">pnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.01</span>))</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>TSextra <span class="ot">=</span> <span class="fu">list</span>(<span class="at">qnull =</span> <span class="cf">function</span>(x, <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="fu">qnorm</span>(x, p[<span class="dv">1</span>], <span class="fu">ifelse</span>(p[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>, p[<span class="dv">2</span>], <span class="fl">0.01</span>)))</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(<span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="fu">rnorm</span>(<span class="dv">500</span>, p[<span class="dv">1</span>], p[<span class="dv">2</span>])</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">mu=</span><span class="dv">0</span>) <span class="fu">rnorm</span>(<span class="dv">100</span>, mu)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>phat <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, <span class="cn">NA</span>, rnull, ralt, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">phat=</span> phat, </span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>          <span class="at">TSextra=</span>TSextra, <span class="at">B=</span>Bsim, <span class="at">maxProcessor=</span><span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co">#&gt; maxProcessor set to 1 for faster computation</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt;      KS     K    AD   CvM     W    ZA    ZK    ZC Wassp1 ES-l-P ES-s-P EP-l-P</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt; 0 0.956 0.912 0.040 0.040 0.046 0.522 0.002 0.006  0.948  0.046  0.064  0.054</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co">#&gt; 1 0.952 0.894 0.038 0.048 0.048 0.568 0.008 0.022  0.930  0.058  0.068  0.062</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt;   EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt; 0  0.068  0.050  0.060  0.054  0.074</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt; 1  0.062  0.078  0.068  0.062  0.070</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">df=</span><span class="dv">1</span>) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co"># t distribution truncated at +- 5  </span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rt</span>(<span class="dv">1000</span>, df)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  x<span class="ot">=</span>x[<span class="fu">abs</span>(x)<span class="sc">&lt;</span><span class="dv">5</span>]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>}  </span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, <span class="cn">NA</span>, rnull, ralt, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">50</span>), <span class="at">phat=</span>phat, </span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>          <span class="at">Range=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="at">TSextra=</span>TSextra, <span class="at">B=</span>Bsim, <span class="at">maxProcessor=</span><span class="dv">2</span>)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">#&gt; maxProcessor set to 1 for faster computation</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt;       KS     K    AD  CvM     W    ZA    ZK    ZC Wassp1 ES-l-P ES-s-P EP-l-P</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt; 2  1.000 0.992 0.638 0.60 0.616 0.940 0.146 0.184  1.000  0.236  0.282  0.174</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="co">#&gt; 50 0.968 0.930 0.052 0.05 0.054 0.574 0.004 0.016  0.996  0.040  0.072  0.052</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt;    EP-s-P ES-l-L ES-s-L EP-l-L EP-s-L</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co">#&gt; 2   0.230  0.216  0.296  0.194  0.236</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">#&gt; 50  0.058  0.046  0.078  0.052  0.080</span></span></code></pre></div>
</div>
</div>
<div id="running-other-tests" class="section level3">
<h3>Running other tests</h3>
<p>Its is very easy for a user to add other goodness-of-fit tests to the
package. This can be done by editing the routines
<strong>TS_cont</strong> and/or <strong>TS_disc</strong>, which are
located in the folder <em>inst/examples</em> in the Rgof library folder.
Or a user can write their own version of these files.</p>
<p><strong>Example</strong></p>
<p>Say we wish to use a test that is a variant of the Cramer-vonMises
test, using the integrated absolute difference of the empirical and the
theoretical distribution function:</p>
<p><span class="math display">\[\int_{-\infty}^{\infty} \vert F(x) -
\hat{F}(x) \vert dF(x)\]</span> For continuous data we have the
routine</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>newTScont <span class="ot">=</span> <span class="cf">function</span>(x, pnull, param) {</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>   Fx<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">pnull</span>(x))</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>   n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>   out <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>( (<span class="dv">2</span><span class="sc">*</span><span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>n<span class="sc">-</span>Fx ))</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>   <span class="fu">names</span>(out) <span class="ot">=</span> <span class="st">&quot;CvM alt&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>   out</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>}</span></code></pre></div>
<p>This routine has to have three or four arguments x, pnull, param and
(optionally) TSextra. x is the data and pnull a function that finds the
cdf at x. param has to be the estimated parameters in the case of a
composite null hypothesis, and is ignored in the case of a simple null
hypothesis. Tsextra has to be a list of additional items needed for the
calculation of the test statistic.</p>
<p>Note that the return object has to be a <strong>named</strong>
vector.</p>
<p>Then we can run this test with</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">punif</span>(x)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>() <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>()</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>Rgof<span class="sc">::</span><span class="fu">gof_test</span>(x, <span class="cn">NA</span>, pnull, rnull, <span class="at">TS=</span>newTScont)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co">#&gt; $statistics</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt;  6.0226 </span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co">#&gt; $p.values</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#&gt;   0.542</span></span></code></pre></div>
<p>Say we want to find the power of this test when the true distribution
is a linear:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">slope=</span><span class="dv">0</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="cf">if</span>(slope<span class="sc">==</span><span class="dv">0</span>) y<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>    <span class="cf">else</span> y<span class="ot">=</span>(slope<span class="dv">-1</span><span class="sc">+</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">-</span>slope)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>slope<span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">500</span>)))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>slope</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, <span class="cn">NA</span>, rnull, ralt, <span class="at">TS=</span>newTScont, <span class="at">param_alt=</span><span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length=</span><span class="dv">3</span>), <span class="dv">3</span>), <span class="at">Range=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">B=</span>Bsim)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co">#&gt; Using  23  cores..</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#&gt; maxProcessor set to 1 for faster computation</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#&gt;      CvM alt</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co">#&gt; 0      0.048</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; 0.25   0.900</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#&gt; 0.5    1.000</span></span></code></pre></div>
<p>for discrete data we will write the routine using Rcpp:</p>
<p>(For reasons to avoid issues with CRAN submission this routine is
already part of Rgof)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>NumericVector newTSdisc<span class="op">(</span>IntegerVector x<span class="op">,</span> </span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>                      Function pnull<span class="op">,</span>  </span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>                      NumericVector param<span class="op">,</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>                      NumericVector vals<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>    </span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  Rcpp<span class="op">::</span>CharacterVector methods<span class="op">=</span>CharacterVector<span class="op">::</span>create<span class="op">(</span><span class="st">&quot;CvM alt&quot;</span><span class="op">);</span>    </span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="dt">int</span> <span class="at">const</span> nummethods<span class="op">=</span>methods<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="dt">int</span> k<span class="op">=</span>x<span class="op">.</span>size<span class="op">(),</span> n<span class="op">,</span> i<span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  NumericVector TS<span class="op">(</span>nummethods<span class="op">),</span> ecdf<span class="op">(</span>k<span class="op">),</span> Fx<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>  <span class="dt">double</span> tmp<span class="op">;</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>  TS<span class="op">.</span>names<span class="op">()</span> <span class="op">=</span>  methods<span class="op">;</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  Fx<span class="op">=</span>pnull<span class="op">(</span>param<span class="op">);</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  n<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>k<span class="op">;++</span>i<span class="op">)</span> n <span class="op">=</span> n <span class="op">+</span> x<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  ecdf<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">=</span> <span class="dt">double</span><span class="op">(</span>x<span class="op">(</span><span class="dv">0</span><span class="op">))/</span><span class="dt">double</span><span class="op">(</span>n<span class="op">);</span>  </span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>k<span class="op">;++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>    ecdf<span class="op">(</span>i<span class="op">)</span> <span class="op">=</span> ecdf<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> x<span class="op">(</span>i<span class="op">)/</span><span class="dt">double</span><span class="op">(</span>n<span class="op">);</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  tmp <span class="op">=</span> <span class="bu">std::</span>abs<span class="op">(</span>ecdf<span class="op">[</span><span class="dv">0</span><span class="op">]-</span>Fx<span class="op">(</span><span class="dv">0</span><span class="op">))*</span>Fx<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>k<span class="op">;++</span>i<span class="op">)</span> </span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>     tmp <span class="op">=</span> tmp <span class="op">+</span> <span class="bu">std::</span>abs<span class="op">(</span>ecdf<span class="op">(</span>i<span class="op">)-</span>Fx<span class="op">(</span>i<span class="op">))*(</span>Fx<span class="op">(</span>i<span class="op">)-</span>Fx<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>  TS<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a> </span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>  <span class="cf">return</span> TS<span class="op">;</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The routine has to have four or five arguments x, pnull, param, vals
and (optionally) TSextra. The output vector has to have names.</p>
<p>Note that one drawback of writing the routine in Rcpp is that it is
then not possible to use multiple processors.</p>
<p>As an example we will test whether some data comes from a Binomial
distribution with n=10 trials. The success parameter p will be estimated
from the data:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>vals<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>pnull <span class="ot">=</span> <span class="cf">function</span>(p) <span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, p) </span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>rnull <span class="ot">=</span> <span class="cf">function</span>(p) <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">rbinom</span>(<span class="dv">10000</span>, <span class="dv">10</span>, p)))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>phat<span class="ot">=</span><span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span><span class="sc">*</span>x)<span class="sc">/</span><span class="dv">100000</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnull</span>(<span class="fl">0.5</span>)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="fu">gof_test</span>(x, vals, pnull, rnull, <span class="at">phat=</span>phat, <span class="at">TS=</span>Rgof<span class="sc">::</span>newTSdisc)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#&gt; $statistics</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co">#&gt;  CvM alt </span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="co">#&gt; 0.002122 </span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co">#&gt; $p.values</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co">#&gt; CvM alt </span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="co">#&gt;  0.4174</span></span></code></pre></div>
<p>For the power calculations we will consider data that is actually a
mixture of two Binomials:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>ralt <span class="ot">=</span> <span class="cf">function</span>(<span class="at">tau=</span><span class="dv">0</span>) {</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>   x<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">5000</span>, <span class="dv">10</span>, <span class="fl">0.5</span><span class="sc">-</span>tau)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>   y<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">5000</span>, <span class="dv">10</span>, <span class="fl">0.5</span><span class="sc">+</span>tau) </span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>   <span class="fu">table</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,x,y))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>}</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="fu">gof_power</span>(pnull, vals, rnull, ralt,</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>    <span class="at">TS=</span>Rgof<span class="sc">::</span>newTSdisc, <span class="at">phat=</span>phat, </span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>    <span class="at">param_alt=</span><span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="at">length=</span><span class="dv">3</span>), <span class="dv">3</span>),</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>    <span class="at">B=</span>Bsim, <span class="at">maxProcessor =</span> <span class="dv">1</span>)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="co">#&gt;       CvM alt</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="co">#&gt; 0       0.052</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co">#&gt; 0.025   0.258</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co">#&gt; 0.05    1.000</span></span></code></pre></div>
</div>
<div id="adjusted-p-values-for-several-tests" class="section level3">
<h3>Adjusted p values for Several Tests</h3>
<p>As no single test can be relied upon to consistently have good power,
it is reasonable to employ several of them. We could then reject the
null hypothesis if any of the tests does so, that is, if the smallest
p-value is less than the desired type I error probability <span class="math inline">\(\alpha\)</span>.</p>
<p>This procedure clearly suffers from the problem of simultaneous
inference, and the true type I error probability will be much larger
than <span class="math inline">\(\alpha\)</span>. It is however possible
to adjust the p value so it does achieve the desired <span class="math inline">\(\alpha\)</span>. This can be done as follows:</p>
<p>We generate a number of data sets under the null hypothesis.
Generally about 1000 will be sufficient. Then for each simulated data
set we apply the tests we wish to include, and record the smallest p
value. Here is an example. Say the null hypothesis specifies a uniform
<span class="math inline">\([0.1]\)</span> and a sample size of 250.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>pnull<span class="ot">=</span><span class="cf">function</span>(x) <span class="fu">punif</span>(x)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>rnull<span class="ot">=</span><span class="cf">function</span>() <span class="fu">runif</span>(<span class="dv">250</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>pvals<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">16</span>)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) pvals[i, ]<span class="ot">=</span>Rgof<span class="sc">::</span><span class="fu">gof_test</span>(<span class="fu">rnull</span>(), <span class="cn">NA</span>, pnull, rnull,<span class="at">B=</span><span class="dv">1000</span>)<span class="sc">$</span>p.values</span></code></pre></div>
<p>Next we find the smallest p value in each run for two selections of
four methods. One is the selection found to be best above, namely the
methods by Wilson, Anderson-Darling, Zhang’s ZC and a chi square test
with a small number of bins and using Pearson’s formula. As a second
selection we use the methods by Kolmogorov-Smirnov, Kuiper,
Anderson-Darling and Cramer-vonMises. It can be checked that for this
null hypothesis these methods are highly correlated.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">colnames</span>(pvals)<span class="ot">=</span><span class="fu">names</span>(Rgof<span class="sc">::</span><span class="fu">gof_test</span>(<span class="fu">rnull</span>(), <span class="cn">NA</span>, pnull, rnull,<span class="at">B=</span><span class="dv">10</span>)<span class="sc">$</span>p.values)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">apply</span>(pvals[, <span class="fu">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;ZC&quot;</span>, <span class="st">&quot;AD&quot;</span>, <span class="st">&quot;ES-s-P&quot;</span> )], <span class="dv">1</span>, min)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">apply</span>(pvals[, <span class="fu">c</span>(<span class="st">&quot;KS&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;AD&quot;</span>, <span class="st">&quot;CvM&quot;</span>)], <span class="dv">1</span>, min)</span></code></pre></div>
<p>Next we find the empirical distribution function for the two sets of
p values and draw their graphs. We also add the curve for the cases of
four identical tests and the case of four independent tests, which of
course is the Bonferroni correction. The data for the cdf is in the
inst/extdata directory of the package</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>tmp<span class="ot">=</span>Rgof<span class="sc">::</span>pvaluecdf</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>Tests<span class="ot">=</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Identical Tests&quot;</span>, <span class="fu">nrow</span>(tmp)),</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="st">&quot;Correlated Selection&quot;</span>, <span class="fu">nrow</span>(tmp)),</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="st">&quot;Best Selection&quot;</span>, <span class="fu">nrow</span>(tmp)),</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="st">&quot;Independent Tests&quot;</span>, <span class="fu">nrow</span>(tmp))),</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>        <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Identical Tests&quot;</span>,  <span class="st">&quot;Correlated Selection&quot;</span>, </span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>                 <span class="st">&quot;Best Selection&quot;</span>, <span class="st">&quot;Independent Tests&quot;</span>),</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>        <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>dta<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(tmp[,<span class="dv">1</span>],tmp[,<span class="dv">1</span>],tmp[,<span class="dv">1</span>],tmp[,<span class="dv">1</span>]),</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>          <span class="at">y=</span><span class="fu">c</span>(tmp[,<span class="dv">1</span>],tmp[,<span class="dv">3</span>],tmp[,<span class="dv">2</span>],<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>tmp[,<span class="dv">1</span>])<span class="sc">^</span><span class="dv">4</span>),</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>          <span class="at">Tests=</span>Tests)</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data=</span>dta, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">col=</span>Tests))<span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">linewidth=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;p value&quot;</span>, <span class="at">y=</span><span class="st">&quot;CDF&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>, <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="weighted-data" class="section level3">
<h3>Weighted Data</h3>
<p>Sometimes the data/model uses importance sampling weights. This can
be done as follows. Say we want to test whether the data comes from a
standard normal distribution, truncated to [-3,3] and with weights from
a t distribution with 3 degrees of freedom:</p>
<p><span class="math inline">\(H_0: F=N(0,1)\)</span>, <span class="math inline">\(X\sim t(3)\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>df<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>pnull<span class="ot">=</span><span class="cf">function</span>(x) <span class="fu">pnorm</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="dv">3</span>)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>rnull<span class="ot">=</span><span class="cf">function</span>() {x<span class="ot">=</span><span class="fu">rt</span>(<span class="dv">2000</span>, df);x<span class="ot">=</span>x[<span class="fu">abs</span>(x)<span class="sc">&lt;</span><span class="dv">3</span>];<span class="fu">sort</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>])}</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>w<span class="ot">=</span><span class="cf">function</span>(x) (<span class="fu">dnorm</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="dv">3</span>)<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="fu">dt</span>(x,df)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="dv">3</span>,df)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">rnull</span>())</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">w</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span><span class="fu">max</span>(<span class="fu">w</span>(x))))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>ralt<span class="ot">=</span><span class="cf">function</span>(<span class="at">m=</span><span class="dv">0</span>) {x<span class="ot">=</span><span class="fu">rt</span>(<span class="dv">2000</span>,df)<span class="sc">+</span>m;x<span class="ot">=</span>x[<span class="fu">abs</span>(x)<span class="sc">&lt;</span><span class="dv">3</span>];<span class="fu">sort</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>])}</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>Rgof<span class="sc">::</span><span class="fu">gof_power</span>(pnull, <span class="cn">NA</span>, rnull, ralt, <span class="at">w=</span>w, <span class="at">param_alt =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="at">Range=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="at">B=</span>Bsim)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co">#&gt; Using  23  cores..</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="co">#&gt; maxProcessor set to 1 for faster computation</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co">#&gt;        KS     K   CvM    AD</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a><span class="co">#&gt; 0   0.052 0.052 0.068 0.056</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a><span class="co">#&gt; 0.2 0.998 0.998 1.000 0.998</span></span></code></pre></div>
<p>It should be noted that these tests are quite sensitive to the size
of the weights and to the sample size, so one should always do a
simulation study to verify that they work in the case under
consideration.</p>
</div>
<div id="case-studies" class="section level3">
<h3>Case Studies</h3>
<p>The package includes the routine <em>run.studies</em>, which provides
20 case studies each for the continuous and the discrete case. This
allows the user to easily compare the power of the methods included in
the package to a different one of their choice.</p>
<p>If the user supplied method only yields the test statistic,
simulation is used to find the p value. If the new test can find p
values, these are used and then the routine will of course run much
faster.</p>
<p>Say a user wishes to study the performance of the chi square test for
the case where the null hypothesis specifies a uniform distribution but
the data actually comes from a linear distribution with slope s. (This
test is of course already included in the package, so this is for
illustration purposes only). So</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>chitest<span class="ot">=</span><span class="cf">function</span>(x, pnull, param, TSextra) {</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>    nbins<span class="ot">=</span>TSextra<span class="sc">$</span>nbins <span class="co">#number of bins</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>    bins<span class="ot">=</span><span class="fu">seq</span>(<span class="fu">min</span>(x)<span class="sc">-</span><span class="fl">1e-10</span>, <span class="fu">max</span>(x)<span class="sc">+</span><span class="fl">1e-10</span>, <span class="at">length=</span>nbins<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>    O<span class="ot">=</span><span class="fu">hist</span>(x, bins, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>counts <span class="co">#bin counts</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>    <span class="cf">if</span>(param[<span class="dv">1</span>]<span class="sc">!=-</span><span class="dv">99</span>) { <span class="co">#with parameter estimation</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>        E<span class="ot">=</span><span class="fu">length</span>(x)<span class="sc">*</span><span class="fu">diff</span>(<span class="fu">pnull</span>(bins, param)) <span class="co">#expected counts</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>        chi<span class="ot">=</span><span class="fu">sum</span>((O<span class="sc">-</span>E)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>E) <span class="co">#Pearson&#39;s chi square</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>        pval<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(chi, nbins<span class="dv">-1</span><span class="sc">-</span><span class="fu">length</span>(param)) <span class="co">#p value</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>    }</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>      E<span class="ot">=</span><span class="fu">length</span>(x)<span class="sc">*</span><span class="fu">diff</span>(<span class="fu">pnull</span>(bins))</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>      chi<span class="ot">=</span><span class="fu">sum</span>((O<span class="sc">-</span>E)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>E)</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>      pval<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(chi,nbins<span class="dv">-1</span>)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>    }  </span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">ifelse</span>(TSextra<span class="sc">$</span>statistic, chi, pval)</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>    <span class="fu">names</span>(out)<span class="ot">=</span><span class="st">&quot;ChiSquare&quot;</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>    out</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>}</span></code></pre></div>
<p>In this example we find the power of <em>chitest</em> when the null
hypothesis specifies a uniform distribution but the true distribution is
a linear with slope s:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>TSextra<span class="ot">=</span><span class="fu">list</span>(<span class="at">nbins=</span><span class="dv">5</span>, <span class="at">statistic=</span><span class="cn">FALSE</span>)</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>pwr<span class="ot">=</span>Rgof<span class="sc">::</span><span class="fu">run.studies</span>(chitest, <span class="st">&quot;uniform.linear&quot;</span>, <span class="at">TSextra=</span>TSextra, <span class="at">With.p.value=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="co">#&gt; Running case uniform.linear.cont ...</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>Rgof<span class="sc">::</span><span class="fu">plot_power</span>(pwr, <span class="st">&quot;Slope&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Arguments of <em>run.studies</em>:</p>
<ul>
<li>study: either the name(s) or position(s) of the desired sudies in
the list of all studies<br />
</li>
<li>TS: new test statistic<br />
</li>
<li>study: the name of the case study. If missing all 20 are run<br />
</li>
<li>TSextra: a list passed to TS<br />
</li>
<li>With.p.value =FALSE set to TRUE if the user supplied method
calculates p values<br />
</li>
<li>BasicComparison = TRUE: if TRUE one value of the parameters under
the alternative is chosen for each case study and all 20 studies are
run</li>
<li>nsample =500: desired sample size.</li>
<li>alpha = 0.05: desired true type I error probability<br />
</li>
<li>param_alt: a vector of values of the parameter of the alternative
distribution. If missing the ones included in Rgof are used. If more
than one study is run this needs to be a list of vectors<br />
</li>
<li>B=c(1000, 1000) number of simulation runs</li>
</ul>
<p>The arguments of the user supplied test routine have to be</p>
<p><strong>Continuous Data:</strong></p>
<ul>
<li>x: the data set<br />
</li>
<li>pnull: a routine to calculate the distribution function<br />
</li>
<li>param: if parameters of pnull are estimated, this is vector of
parameter estimates. If no parameters are estimated, this is ignored but
has to be present.<br />
</li>
<li>TSextra: a list with any object needed to calculate the test
statistic / p value.</li>
</ul>
<p><strong>Discrete Data</strong></p>
<ul>
<li>x: the data set (the counts)</li>
<li>pnull: a routine to calculate the distribution function<br />
</li>
<li>param: if parameters of pnull are estimated, this is vector of
parameter estimates. If no parameters are estimated, this is ignored but
has to be present.<br />
</li>
<li>vals: the possible values of the discrete random variable.</li>
<li>TSextra: a list with any object needed to calculate the test
statistic / p value.</li>
</ul>
<p>In either case the output of the routine has to be a named vector
with either the test statistic(s) or the p values(s).</p>
<p>The case studies are as follows. In each the first term specifies the
model under the null hypothesis and the second the model under the
alternative hypothesis. The cases studies with names ending in .est
include parameter estimation.</p>
<p><strong>Without parameter estimation</strong></p>
<ol style="list-style-type: decimal">
<li><p>uniform.linear<span class="math inline">\(\hspace{3cm}\)</span>
U[0,1] vs a linear model on [0,1] with slope s.</p></li>
<li><p>uniform.quadratic<span class="math inline">\(\hspace{2.5cm}\)</span> U[0,1] vs a quadratic
model with vertex at 0.5 and some curvature a.</p></li>
<li><p>uniform.bump<span class="math inline">\(\hspace{3.1cm}\)</span>
U[0,1] vs U[0,1]+N(0.5,0.05).</p></li>
<li><p>uniform.sine<span class="math inline">\(\hspace{3.3cm}\)</span>
U[0,1] vs U[0,1]+Sine wave</p></li>
<li><p>beta22.betaaa<span class="math inline">\(\hspace{3cm}\)</span>
Beta(2,2) vs Beta(a,a)</p></li>
<li><p>beta22.beta2a<span class="math inline">\(\hspace{3cm}\)</span>
Beta(2,2) vs Beta(2,a)</p></li>
<li><p>normal.shift<span class="math inline">\(\hspace{3.5cm}\)</span>
N(0,1) vs N(<span class="math inline">\(\mu\)</span>,1)</p></li>
<li><p>normal.stretch<span class="math inline">\(\hspace{3.1cm}\)</span>
N(0,1) vs N(0, <span class="math inline">\(\sigma\)</span>)</p></li>
<li><p>normal.t<span class="math inline">\(\hspace{4.2cm}\)</span>
N(0,1) vs t(df)</p></li>
<li><p>normal.outlier1<span class="math inline">\(\hspace{3.1cm}\)</span> N(0,1) vs
N(0,1)+U[2,3]</p></li>
<li><p>normal.outlier2<span class="math inline">\(\hspace{3.1cm}\)</span> N(0,1) vs
N(0,1)+U[-3,-2]+U[2,3]</p></li>
<li><p>exponential.gamma<span class="math inline">\(\hspace{2.3cm}\)</span> Exp(1) vs
Gamma(1,b)</p></li>
<li><p>exponential.weibull<span class="math inline">\(\hspace{2.5cm}\)</span> Exp(1) vs
Weibull(1,b)</p></li>
<li><p>exponential.bump<span class="math inline">\(\hspace{2.7cm}\)</span> Exp(1) vs
Exp(1)+N(0.5,0.05)</p></li>
<li><p>trunc.exponential.linear<span class="math inline">\(\hspace{1.7cm}\)</span> Exp(1) vs Linear, on
[0,1]</p></li>
</ol>
<p><strong>With parameter estimation</strong></p>
<ol start="16" style="list-style-type: decimal">
<li><p>normal.t.est<span class="math inline">\(\hspace{3.7cm}\)</span>
N(<span class="math inline">\(\mu\)</span>,<span class="math inline">\(\sigma\)</span>) vs t(df)</p></li>
<li><p>exponential.weibull.est<span class="math inline">\(\hspace{1.9cm}\)</span> Exp(<span class="math inline">\(\lambda\)</span>) vs Weibull(1,b)</p></li>
<li><p>trunc.exponential.linear.est<span class="math inline">\(\hspace{1.2cm}\)</span> Exp(<span class="math inline">\(\lambda\)</span>) vs Linear, on [0,1]</p></li>
<li><p>exponential.gamma.est<span class="math inline">\(\hspace{1.8cm}\)</span> Exp(<span class="math inline">\(\lambda\)</span>) vs Gamma(1,b)</p></li>
<li><p>normal.cauchy.est<span class="math inline">\(\hspace{2.7cm}\)</span> N(<span class="math inline">\(\mu\)</span>,<span class="math inline">\(\sigma\)</span>) vs Cauchy (Breit-Wigner)</p></li>
</ol>
<p>Generally a user will likely wish to run all the included case
studies. This is very easily done with</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>Rgof<span class="sc">::</span><span class="fu">run.studies</span>(chitest, <span class="at">TSextra=</span>TSextra, <span class="at">With.p.value=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>If only the test statistic is supplied by the new test and therefore
simulation has to be used to find p values, this will take several hours
to run. <em>run.studies</em> can also be used to run the studies for the
included methods but for different values of param_alt, nsample and/or
alpha. For example, say we wish to find the powers of the included
continuous methods for the case uniform.linear and samples of size 2000,
slopes of 0.1 and 0.2, and a true type I error of 0.01:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>Rgof<span class="sc">::</span><span class="fu">run.studies</span>(<span class="cn">TRUE</span>, <span class="co"># continuous data/model</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>                  <span class="at">study=</span><span class="st">&quot;uniform.linear&quot;</span>,</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>                  <span class="at">param_alt=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>),</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>                  <span class="at">nsample=</span><span class="dv">2000</span>,</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>                  <span class="at">alpha=</span><span class="fl">0.01</span>)</span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-anderson1962" class="csl-entry">
Anderson, T W. 1962. <span>“On the Distribution of the Two-Sample
<span>C</span>ramer-von <span> M</span>ises Criterion.”</span>
<em>Annals of Mathematical Statistics</em> 33 (3): 1148–59.
</div>
<div id="ref-anderson1952" class="csl-entry">
Anderson, T W, and D A Darling. 1952. <span>“Asymptotic Theory of
Certain Goodness-of-Fit Criteria Based on Stochastic Processes.”</span>
<em>Annals of Mathematical Statistics</em> 23: 193–212.
</div>
<div id="ref-anderson1954" class="csl-entry">
———. 1954. <span>“A Test of Goodness-of-Fit.”</span> <em>JASA</em> 49:
765–69.
</div>
<div id="ref-berkson1980" class="csl-entry">
Berkson, J. 1980. <span>“Minimum Chi-Square, Not Maximum
Likelihood.”</span> <em>Ann. Math. Stat</em> 8 (3): 457–87.
</div>
<div id="ref-wasserstein1999" class="csl-entry">
E del Barrio, C Matran, J A Cuesta-Albertos. 1999. <span>“Tests of
Goodness of Fit Based on the L2-Wasserstein Distance.”</span> <em>Annals
of Statistics</em> 1230-1239: 27.
</div>
<div id="ref-kolmogorov1933" class="csl-entry">
Kolmogorov, A. 1933. <span>“Sulla Determinazione Empirica Di Una Legge
Di Distribuzione.”</span> <em>G. Ist. Ital. Attuari.</em> 4: 83–91.
</div>
<div id="ref-kuiper1960" class="csl-entry">
Kuiper, N H. 1960. <span>“Tests Concerning Random Points on a
Circle.”</span> <em>Proceedings of the Koninklijke Nederlandse Akademie
van Wetenschappen</em> 63: 38–47.
</div>
<div id="ref-massey1951" class="csl-entry">
Massey, F J. 1951. <span>“The
<span>K</span>olmogorov-<span>S</span>mirnov Test for
Goodness-of-Fit.”</span> <em>JASA</em> 46: 68–78.
</div>
<div id="ref-rolke2020" class="csl-entry">
Rolke, Wolfgang, and Cristian Gutierrez-Gongora. 2020. <span>“A
Chi-Square Goodness-of-Fit Test for Continuous Distributions Against a
Known Alternative.”</span> <em>Computational Statistics</em>. <a href="https://doi.org/10.1007/s00180-020-00997-x">https://doi.org/10.1007/s00180-020-00997-x</a>.
</div>
<div id="ref-smirnov1948" class="csl-entry">
Smirnov, N. 1948. <span>“Table for Estimating the Goodness of Fit of
Empirical Distributions.”</span> <em>Annals of Mathematical
Statistics</em> 19: 279–81.
</div>
<div id="ref-zhang2002" class="csl-entry">
Zhang, J. 2002. <span>“Powerful Goodness-of-Fit Tests Based on
Likelihood Ratio.”</span> <em>Journal of the RSS (Series B)</em> 64:
281–94.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
